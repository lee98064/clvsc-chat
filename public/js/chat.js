!function(e){var t={};function a(s){if(t[s])return t[s].exports;var n=t[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=t,a.d=function(e,t,s){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(s,n,function(t){return e[t]}.bind(null,n));return s},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/",a(a.s=78)}({78:function(e,t,a){e.exports=a(79)},79:function(t,a){function s(){$(".card-body").animate({scrollTop:$(".card-body").prop("scrollHeight")})}function n(){$(".message-text").magnificPopup({delegate:"img",type:"image",gallery:{enabled:!1}})}Echo.channel("onlinechat").listen("OnlinechatEvent",(function(e){if(null!=e.message.deleted_at)$("div[data-msid="+e.message.id+"]").children(".message-group").children(".message-text").html("對方已收回訊息");else if(null!=e.message.content){var t='<div class="message" data-msid="'+e.message.id+'"><img class="author-img" src="'+e.message.user.profile_photo_url+'" alt="'+e.message.user.name+'">';t+='<div class="message-group"><div class="author text-muted">'+e.message.user.name,t+='</div><div class="message-text">'+e.message.content+"</div></div></div>"}else{t='<div class="message" data-msid="'+e.message.id+'"><img class="author-img" src="'+e.message.user.profile_photo_url+'" alt="'+e.message.user.name+'">';t+='<div class="message-group"><div class="author text-muted">'+e.message.user.name,t+='</div><div class="message-text"><img src="'+e.message.attachment+'" href="'+e.message.attachment+'"></div></div></div>',n()}$(".chatbox>.card-body").append(t),s()})),$(document).ready((function(){$("#send-message").submit((function(e){if(e.preventDefault(),""!=$("input[name='content']").val()){var t=$(this).serialize();$.ajax({type:"post",url:"/chats",data:t,dataType:"JSON",success:function(e){var t='<div class="message me" data-msid="'+e.id+'"><div class="message-group"><div class="author text-muted">'+e.user.name;t+='</div><div class="message-text">'+e.content+'</div></div><button class="btn btn-light btn-sm remove-message" data-msid="'+e.id+'"><i class="fas fa-trash fa-fw"></i></button></div>',$(".chatbox>.card-body").append(t),$("input[name='content']").val(""),$("input[name='content']").focus(),s()}})}else alert("請輸入訊息!")})),$("#go-back").click((function(e){location.href="/"})),$("#send-image-file").change((function(e){if(this.files&&this.files[0]){var t=new FileReader;t.onload=function(e){$("#send-image-preview").attr("src",e.target.result),$("#send-image-preview").css("opacity","1")},$("#send-image-label").html(this.files[0].name),t.readAsDataURL(this.files[0])}e.preventDefault()})),$("#send-image").submit((function(e){if(e.preventDefault(),$("#send-image-file").prop("files")&&$("#send-image-file").prop("files")[0]){var t=new FormData;t.append("_token",$("input[name='_token']").prop("value")),t.append("attachment",$("#send-image-file").prop("files")[0]),$.ajax({type:"post",url:"/chats",data:t,processData:!1,contentType:!1,dataType:"JSON",success:function(e){var t='<div class="message me" data-msid="'+e.id+'"><div class="message-group"><div class="author text-muted">'+e.user.name;t+='</div><div class="message-text"><img src="'+e.attachment+'" href="'+e.attachment+'"></div></div><button class="btn btn-light btn-sm remove-message" data-msid="'+e.id+'"><i class="fas fa-trash fa-fw"></i></button></div>',$(".chatbox>.card-body").append(t),$("input[name='content']").val(""),$("input[name='content']").focus(),$("#send-image-modal").modal("hide"),$("#send-image-file").val(""),$("#send-image-label").html("選擇檔案"),$("#send-image-preview").attr("src","#"),$("#send-image-preview").css("opacity","0"),n(),s()},error:function(e){alert("發生錯誤!，請稍後再試!")}})}else alert("請選擇圖片!")})),$(document).on("click",".remove-message",(function(){e=$(this),confirm("確定收回這則訊息?")&&$.ajax({type:"POST",url:"/chats/"+$(this).data("msid"),data:{_token:$("input[name='_token']").prop("value"),_method:"delete"},dataType:"JSON",success:function(t){$('div[data-msid="'+t.id+'"]').children(".message-group").children(".message-text").html("您已收回訊息"),$('div[data-msid="'+t.id+'"]').data("msid","N"),e.remove()},error:function(e){alert("收回失敗")}})})),n(),s()}))}});